<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · CUDA.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-154489943-2', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link rel="canonical" href="https://juliagpu.github.io/CUDA.jl/stable/usage/overview/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="CUDA.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">CUDA.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/introduction/">Introduction</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../../installation/overview/">Overview</a></li><li><a class="tocitem" href="../../installation/conditional/">Conditional use</a></li><li><a class="tocitem" href="../../installation/troubleshooting/">Troubleshooting</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#The-CuArray-type"><span>The <code>CuArray</code> type</span></a></li><li><a class="tocitem" href="#Kernel-programming-with-@cuda"><span>Kernel programming with <code>@cuda</code></span></a></li><li><a class="tocitem" href="#CUDA-API-wrappers"><span>CUDA API wrappers</span></a></li></ul></li><li><a class="tocitem" href="../workflow/">Workflow</a></li><li><a class="tocitem" href="../array/">Array programming</a></li><li><a class="tocitem" href="../memory/">Memory management</a></li><li><a class="tocitem" href="../multitasking/">Tasks and threads</a></li><li><a class="tocitem" href="../multigpu/">Multiple GPUs</a></li></ul></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../../development/profiling/">Profiling</a></li><li><a class="tocitem" href="../../development/troubleshooting/">Troubleshooting</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../../api/essentials/">Essentials</a></li><li><a class="tocitem" href="../../api/compiler/">Compiler</a></li><li><a class="tocitem" href="../../api/kernel/">Kernel programming</a></li><li><a class="tocitem" href="../../api/array/">Array programming</a></li></ul></li><li><span class="tocitem">Library reference</span><ul><li><a class="tocitem" href="../../lib/driver/">CUDA driver</a></li></ul></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGPU/CUDA.jl/blob/master/docs/src/usage/overview.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="UsageOverview"><a class="docs-heading-anchor" href="#UsageOverview">Overview</a><a id="UsageOverview-1"></a><a class="docs-heading-anchor-permalink" href="#UsageOverview" title="Permalink"></a></h1><p>The CUDA.jl package provides three distinct, but related, interfaces for CUDA programming:</p><ul><li>the <code>CuArray</code> type: for programming with arrays;</li><li>native kernel programming capabilities: for writing CUDA kernels in Julia;</li><li>CUDA API wrappers: for low-level interactions with the CUDA libraries.</li></ul><p>Much of the Julia CUDA programming stack can be used by just relying on the <code>CuArray</code> type, and using platform-agnostic programming patterns like <code>broadcast</code> and other array abstractions. Only once you hit a performance bottleneck, or some missing functionality, you might need to write a custom kernel or use the underlying CUDA APIs.</p><h2 id="The-CuArray-type"><a class="docs-heading-anchor" href="#The-CuArray-type">The <code>CuArray</code> type</a><a id="The-CuArray-type-1"></a><a class="docs-heading-anchor-permalink" href="#The-CuArray-type" title="Permalink"></a></h2><p>The <code>CuArray</code> type is an essential part of the toolchain. Primarily, it is used to manage GPU memory, and copy data from and back to the CPU:</p><pre><code class="language-julia">a = CuArray{Int}(undef, 1024)

# essential memory operations, like copying, filling, reshaping, ...
b = copy(a)
fill!(b, 0)
@test b == CUDA.zeros(Int, 1024)

# automatic memory management
a = nothing</code></pre><p>Beyond memory management, there are a whole range of array operations to process your data. This includes several higher-order operations that take other code as arguments, such as <code>map</code>, <code>reduce</code> or <code>broadcast</code>. With these, it is possible to perform kernel-like operations without actually writing your own GPU kernels:</p><pre><code class="language-julia">a = CUDA.zeros(1024)
b = CUDA.ones(1024)
a.^2 .+ sin.(b)</code></pre><p>When possible, these operations integrate with existing vendor libraries such as CUBLAS and CURAND. For example, multiplying matrices or generating random numbers will automatically dispatch to these high-quality libraries, if types are supported, and fall back to generic implementations otherwise.</p><h2 id="Kernel-programming-with-@cuda"><a class="docs-heading-anchor" href="#Kernel-programming-with-@cuda">Kernel programming with <code>@cuda</code></a><a id="Kernel-programming-with-@cuda-1"></a><a class="docs-heading-anchor-permalink" href="#Kernel-programming-with-@cuda" title="Permalink"></a></h2><p>If an operation cannot be expressed with existing functionality for <code>CuArray</code>, or you need to squeeze every last drop of performance out of your GPU, you can always write a custom kernel. Kernels are functions that are executed in a massively parallel fashion, and are launched by using the <code>@cuda</code> macro:</p><pre><code class="language-julia">a = CUDA.zeros(1024)

function kernel(a)
    i = threadIdx().x
    a[i] += 1
    return
end

@cuda threads=length(a) kernel(a)</code></pre><p>These kernels give you all the flexibility and performance a GPU has to offer, within a familiar language. However, not all of Julia is supported: you (generally) cannot allocate memory, I/O is disallowed, and badly-typed code will not compile. As a general rule of thumb, keep kernels simple, and only incrementally port code while continuously verifying that it still compiles and executes as expected.</p><h2 id="CUDA-API-wrappers"><a class="docs-heading-anchor" href="#CUDA-API-wrappers">CUDA API wrappers</a><a id="CUDA-API-wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#CUDA-API-wrappers" title="Permalink"></a></h2><p>For advanced use of the CUDA, you can use the driver API wrappers in CUDA.jl. Common operations include synchronizing the GPU, inspecting its properties, starting the profiler, etc. These operations are low-level, but for your convenience wrapped using high-level constructs. For example:</p><pre><code class="language-julia">CUDA.@profile begin
    # code that runs under the profiler
end

# or

for device in CUDA.devices()
    @show capability(device)
end</code></pre><p>If such high-level wrappers are missing, you can always access the underling C API (functions and structures prefixed with <code>cu</code>) without having to ever exit Julia:</p><pre><code class="language-julia">version = Ref{Cint}()
CUDA.cuDriverGetVersion(version)
@show version[]</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../installation/troubleshooting/">« Troubleshooting</a><a class="docs-footer-nextpage" href="../workflow/">Workflow »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 2 April 2021 17:08">Friday 2 April 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
