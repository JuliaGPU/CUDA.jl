steps:
  - label: "Documentation"
    depends_on: "cuda"
    env:
      BUILDKITE_PLUGIN_CRYPTIC_BASE64_SIGNED_JOB_ID_SECRET: ${BUILDKITE_PLUGIN_CRYPTIC_BASE64_SIGNED_JOB_ID_SECRET?}
    plugins:
      - JuliaCI/julia#v1:
          version: 1.8
      - staticfloat/cryptic#v2:
          variables:
            - DOCUMENTER_KEY="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"
    command: |
      julia --project -e '
        println("--- :julia: Instantiating project")
        using Pkg
        Pkg.instantiate()
        Pkg.activate("docs")
        Pkg.instantiate()
        push!(LOAD_PATH, @__DIR__)

        println("+++ :julia: Building documentation")
        include("docs/make.jl")'
    agents:
      queue: "juliagpu"
      cuda: "*"
    if: build.message !~ /\[skip docs\]/ && !build.pull_request.draft
    timeout_in_minutes: 30
